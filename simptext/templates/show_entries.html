{% extends "layout.html" %}
{% block body %}
<script type=text/javascript>

$(function() {
  $('#edit-1').click(function(){
    document.getElementById("reverse-1").contentEditable = true;
  });

  $('#edit-2').click(function(){
    document.getElementById("reverse-2").contentEditable = true;
  });

  $('#edit-3').click(function(){
    document.getElementById("reverse-2").contentEditable = true;
  });

  var lastInput = {{ entries | tojson }};
  $('#undo-1').click(function(){
    document.getElementById("reverse-1").innerHTML = lastInput;
  });

  $('#undo-2').click(function(){
    document.getElementById("reverse-2").innerHTML = lastInput;
  });

  $('#undo-3').click(function(){
    document.getElementById("reverse-3").innerHTML = lastInput;
  });

});

</script>
  {% if session.logged_in %}
    <form action="{{ url_for('add_entry') }}" method=post class=add-entry>
      <dl>
        <dt>Input:
        <dd><textarea name=input rows=6 cols=70></textarea>
        {#       
        <dt>Output:
        <dd><textarea name=output rows=5 cols=60></textarea>
        #}
        <dd><input type='button' value=Simplify>
      </dl>


    </form>

  {% endif %}
  
<ul class="entries">
  {% if entries %}
     <li><h2>Input:</h2>
     <li>
     {{ entries }}
     </li>
  {% else %}
     <li><em>No output here so far</em>
  {% endif %}

  <li><h2>Output:<h2></li>
  {% set counter = ['1'] %}
  <li id="reverse-{{counter|length}}">
   {% for item in outputs %} 
        {% if item is mapping %} {# not change #}
   
          {% for key, value in item.iteritems() %}
            <select>
              {% for v in value %}
                 <option value={{ v }} >{{ v |safe}} </option>
              {% endfor %}
            </select>
         
          {% endfor %}

        {% else %}
           {{ item |safe }}

           {% if item == "." %}  {# is a sentence? #} 
               <input type='button' id="edit-{{counter|length}}" value='Edit'/>
               <input type='button' id="undo-{{counter|length}}" value='Undo'/>
               {% if counter.append('1') %}
               {% endif %}
     
               <br></li><li id="reverse-{{counter|length}}">
               
           {% endif %}
              
        {% endif %}

   {% endfor %}  
   </li>
   {#
   <dd><input type='button' id="edit" value='Edit'/>
   <input type='button' id="undo1" value='Undo-S1'/>
   <input type='button' id="undo-2" value='Undo-S2'/>
   #}

</ul>
  <!--
  <script type="text/javascript">
    $(document).ready(function(){
    
    $("#Simplify").click(function(){

     $.getJSON('/', function(dat){
       console.log("Ajax received data!");
       console.dir(dat);
    });
    
    });

    });
  </script>
  -->
  
 {#
  <ul class="entries">
  {% for entry in entries %}
    <li>{{ entry.output|safe }}
  {% else %}
    <li><em>Unbelievable.  No entries here so far</em>
  {% endfor %}
  </ul>
  #}

{% endblock %}
